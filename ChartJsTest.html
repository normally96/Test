<!doctype html>
<html>

<head>
	<title>Line Chart</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
	<style>
	canvas{
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
</head>

<body>
	
	<div class="col-sm-2">
		<label for="ex1">Sensor</label>
		<input class="form-control" id="getSensor" type="text">
	</div>
	
	<button id="chartemit" type="button" class="btn btn-danger">Update chart</button>

	<div class="container">
 		 <form>
 	  			<div class="form-group row">
   				<div class="col-sm-1"><h2>From</h2></div>

	      		<div class="col-sm-2">
		        	<label for="ex1">Date</label>
		        	<input class="form-control" id="fromDate" type="text">
	     		</div>

      			<div class="col-sm-2">
        			<label for="ex2">Hour</label>
        			<input class="form-control" id="fromHour" type="text">
     			 </div>

     			 <div class="col-sm-2">
        			<label for="ex2">Minute</label>
        			<input class="form-control" id="fromMinute" type="text">
     			 </div> 
    		</div>

    		<div class="form-group row">
   				<div class="col-sm-1"><h2>To</h2></div>

	      		<div class="col-sm-2">
		        	<label for="ex1">Date</label>
		        	<input class="form-control" id="toDate" type="text">
	     		</div>

      			<div class="col-sm-2">
        			<label for="ex2">Hour</label>
        			<input class="form-control" id="toHour" type="text">
     			 </div>

     			 <div class="col-sm-2">
        			<label for="ex2">Minute</label>
        			<input class="form-control" id="toMinute" type="text">
     			 </div> 
    		</div>
  		</form>
	</div>

	<div style="width:75%;">
		<canvas id="myChart"></canvas>
	</div>
	<br>
	<br>
	<script>
		var socket = io();
      		 $("#chartemit").click(function(){      
      		 var timeGet= {
      		 	from : [$("#fromDate").val(),$("#fromHour").val(),$("#fromMinute").val()],
      		 	to   : [$("#toDate").val(),$("#toHour").val(),$("#toMinute").val()]
      		 };      
      		 timeGet.sensor = $("#getSensor").val();    
          	 socket.emit('chartemit',timeGet);   
          	 console.log(timeGet);        
      	});

      	socket.on('updateChartJs', (msg)=>{	
       		var newLocations = msg;
       		//addData(window.myLineChart,["hieu","hiehihi","haha"], [12,13,14]);  
       		initChart("myChart", ["hieu"], msg);
       	});

      	function addData(chart, label, data) {
  			chart.data.labels.push(label);
			chart.data.datasets.forEach((dataset) => {
    		dataset.data.push(data);
  			});
  		  	chart.update();
		}
		function initChart(elementID, labels, data) {
			var ctx = document.getElementById(elementID);
			window.myLineChart = new Chart(ctx, {
	  			type: 'line',
	  		  	data: {
		       		labels: data,
		      		datasets: [{
		         		label: '# of Votes',
		          		data: data,
		           		backgroundColor: [
		                 	'rgba(0, 255, 0, 0.3)'
		            	],
		            	borderColor: [
		                	'rgba(255,99,132,1)'
		            	],
		           		borderWidth: 1
		        	}]
	   			},
	  		  	options: {
		       		scales: {
		  		  		yAxes: [{
		       				ticks: {
		          				beginAtZero:true
		       			 	}
		   			 	}]
	       			}
	    		}
			});

		}

      	
	</script>
</body>

</html>
